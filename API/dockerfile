# Imagen base ligera de Python
FROM python:3.10-slim

# Evitar preguntas interactivas en apt
ENV DEBIAN_FRONTEND=noninteractive

# Instalamos dependencias del sistema necesarias para:
# - OpenCV (libgl1, libglib2.0-0)
# - pyttsx3 (espeak / libespeak1)
RUN apt-get update && apt-get install -y --no-install-recommends \
    build-essential \
    libgl1 \
    libglib2.0-0 \
    espeak \
    libespeak1 \
    && rm -rf /var/lib/apt/lists/*

# Directorio de trabajo dentro del contenedor
WORKDIR /app

# Copiamos primero requirements para aprovechar caché de Docker
COPY requirements.txt .

# Instalamos dependencias de Python
RUN pip install --no-cache-dir -r requirements.txt

# Copiamos el resto del código
COPY . .

# Puerto donde expones FastAPI con uvicorn
EXPOSE 8000

# Comando para arrancar el servidor
# Si tu archivo no es main.py, cambia "main:app"
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
